<head>
    <script type="text/javascript" src="../js/dashboard.js"></script>
    <link rel="stylesheet" href="../css/dashboard.css">
    <style>
        .blinkText {
            animation: blinker 1s linear infinite;
        }
    
        @keyframes blinker {
            50% {
                opacity: 0;
            }
        }
    </style>
    <script type="text/javascript">
        var ajaxRet;
        
        function sendAjax(){
            // content-type을 설정하고 데이터 송신
            var xhr = new XMLHttpRequest();
            xhr.open('POST', document.URL.split("/")[0]+'api');
            xhr.setRequestHeader('Content-type', "application/json");
            xhr.send();
            
            var tempObjArr = document.getElementsByClassName("dashboard display-animation")[0].getElementsByTagName("span");
            
            var tempStr;
            var tempObj;
            
            // 데이터 수신이 완료되면 표시
            xhr.addEventListener('load', function(){
                ajaxRet = JSON.parse(xhr.responseText);
                //"pegDon","pesDon","goldBuy","goldSell","excRate","investRate","kospi","kosdaq","dji","nasdaq","btc","dubai","eth","pegGram","pesGram",
                for(var i=0;i<ajaxRet.length;i++){
                    ajaxRet[i].thisValue = new Intl.NumberFormat('ko-KR', { style: 'decimal', maximumFractionDigits: 2}).format(ajaxRet[i].thisValue)
                }
                var contentsArr = [];
                //금 소매 살 때 시세(원/돈) / 금 소매 팔 때 시세(원/돈)
                contentsArr.push(ajaxRet[2].thisValue+" / "+ajaxRet[3].thisValue);
                // 센골드 e금 시세(원/돈)
                contentsArr.push(ajaxRet[0].thisValue);
                // 센골드 e은 시세(원/돈)
                contentsArr.push(ajaxRet[1].thisValue);
                // 환율(원/$)
                contentsArr.push(ajaxRet[4].thisValue);
                // KOSPI(point) / KOSDAQ(point)
                contentsArr.push(ajaxRet[6].thisValue+" / "+ajaxRet[7].thisValue);
                // 국고채 3년만기 금리(%)
                contentsArr.push(ajaxRet[5].thisValue);
                // 국제유가($/배럴)
                contentsArr.push(ajaxRet[11].thisValue);
                // BitCoin(원/BTC)
                contentsArr.push(ajaxRet[10].thisValue);
                // Dow Jones(point) / NASDAQ(point)
                contentsArr.push(ajaxRet[8].thisValue+" / "+ajaxRet[9].thisValue);

                var tempClass;
                var tempColor;
                var tempFontWeight;
                var tempVal;
                var tempStr;

                for(var k=0 ; k < tempObjArr.length ;k+=3){
                    tempObj = tempObjArr[k].getElementsByTagName("h1")[0];
                    tempStr = tempObj.innerText;
                    tempVal = contentsArr[(k/3)];
                    // tempObjArr[k].getElementsByTagName("h1")[0].innerText = contentsArr[(k/3)];
                    
                    if(tempStr != tempVal){
                        // tempColor = "blue";
                        tempClass = "blinkText";
                        // alert(tempStr+":"+tempVal+"___"+tempStr.length+":"+tempVal.length);
                        // tempFontWeight = "bold";
                    }else{
                        // tempColor = "black";
                        tempClass = "";
                        // tempFontWeight = "normal";
                    }
                    tempObj.innerText =  tempVal;
                    tempObj.className = tempClass;
                    // tempObj.style.fontWeight = tempFontWeight
                }
            });
        }
        window.setInterval("sendAjax()", 10000);
    </script>
</head>
<body translate="no" onLoad="sendAjax()">
    <div class="dashboard display-animation" style="margin: 100 auto; width: 1130px;">
        <a class="tile tile-lg tile-pink ripple-effect animated" href="#" style="animation-delay: 0.26s;">
            <span class="content-wrapper">
                <span class="tile-content">
                    <span class="title">
                        <h3>금 소매 살 때 시세(원/돈) / 금 소매 팔 때 시세(원/돈)</h3>
                        <br><h1>247,000 / 226,000</h1>
                    </span>
                </span>
            </span>
        </a>
        <a class="tile tile-lg tile-sqr tile-purple ripple-effect animated" href="#" style="animation-delay: 0.43s;">
            <span class="content-wrapper">
                <span class="tile-content">
                    <span class="title">
                        <h3>센골드 e금 시세(원/돈)</h3>
                        <br><h1>247,000</h1>
                    </span>
                </span>
            </span>
        </a>
        <a class="tile tile-lg tile-sqr tile-cyan ripple-effect animated" href="#" style="animation-delay: 0.54s;">
            <span class="content-wrapper">
                <span class="tile-content">
                    <span class="title">
                        <h3>센골드 e은 시세(원/돈)</h3>
                        <br><h1>2,600</h1>
                    </span>
                </span>
            </span>
        </a>
        <a class="tile tile-lg tile-sqr tile-amber ripple-effect animated" href="#" style="animation-delay: 0.35s;">
            <span class="content-wrapper">
                <span class="tile-content">
                    <span class="title">
                        <h3>환율(원/$)</h3>
                        <br><h1>1,198,25</h1>
                    </span>
                </span>
            </span>
        </a>
        <a class="tile tile-lg tile-light-blue ripple-effect animated" href="#" style="animation-delay: 0.51s;">
            <span class="content-wrapper">
                <span class="tile-content">
                    <span class="title">
                        <h3>KOSPI(point) / KOSDAQ(point)</h3>
                        <br><h1>2,100 / 690</h1>
                    </span>
                </span>
            </span>
        </a>
        <a class="tile tile-lg tile-sqr tile-red ripple-effect animated" href="#" style="animation-delay: 0.68s;">
            <span class="content-wrapper">
                <span class="tile-content">
                    <span class="title">
                        <h3>국고채 3년만기 금리(%)</h3>
                        <br><h1>1.03</h1>
                    </span>
                </span>
            </span>
        </a>
        <a class="tile tile-lg tile-sqr tile-indigo ripple-effect animated" href="#" style="animation-delay: 0.49s;">
            <span class="content-wrapper">
                <span class="tile-content">
                    <span class="title">
                        <h3>국제유가($/배럴)</h3>
                        <br><h1>51.25</h1>
                    </span>
                </span>
            </span>
        </a>
        <a class="tile tile-lg tile-sqr tile-deep-orange ripple-effect animated" href="#" style="animation-delay: 0.6s;">
            <span class="content-wrapper">
                <span class="tile-content">
                    <span class="title">
                        <h3>BitCoin(원/BTC)</h3>
                        <br><h1>10,247,000</h1>
                    </span>
                </span>
            </span>
        </a>
        <a class="tile tile-lg tile-light-green ripple-effect animated" href="#" style="animation-delay: 0.77s;">
            <span class="content-wrapper">
                <span class="tile-content">
                    <span class="title">
                        <h3>Dow Jones(point) / NASDAQ(point)</h3>
                        <br><h1>27,090.86 / 9,018.09</h1>
                    </span>
                </span>
            </span>
        </a>
    </div>
    <script src="https://static.codepen.io/assets/common/stopExecutionOnTimeout-157cd5b220a5c80d4ff8e0e70ac069bffd87a61252088146915e8726e5d9f147.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
</body>